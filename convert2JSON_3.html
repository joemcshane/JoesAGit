<!DOCTYPE html>
<html>
<head>
<script src="./jquery-3.3.1.min.js"></script>
<script src="./mapForm.js"></script>
<script src="./dataSetParsing.js"></script>
<script src="./canvasParsing.js"></script>
  </head>
  <body>
  <button id="convert">Convert to JSON</button>
<br />
<textarea cols = 80 rows=10 id="formsText"></textarea>
<br />*******************************************************
<br />  Models<div id="views">
<textarea cols = 80 rows=10 id="modelsOutput"></textarea>
<br />*******************************************************
<br />  Views<div id="views">
<textarea cols = 80 rows=10 id="viewsHTMLOutput"></textarea>
</div><br />*******************************************************
<br />  DataSets JSON<div id="dataSets">
<textarea cols = 80 rows=10 id="dataSetsOutput"></textarea>
</div>
<br />*******************************************************
<br />  View JSON<div id="views">
<textarea cols = 80 rows=10 id="viewsOutput"></textarea>

  <script>
  $(document).ready(function(){
    $("#convert").click(function(){
	
	  var rawText = $("#formsText").val();
	  
	  var thisForm = mapForm(rawText);
	  jsonForm = thisForm.inJSON();
      $("#result").html(jsonForm);
	
	  formStructure = JSON.parse(jsonForm);
	  
	  var dataSetHtml = formDetails(formStructure);
	  var viewHtml = viewDetails(formStructure);
	  
	  var allViews  = '[';
      for (var i=0; i < viewHtml.views.length; i++) { 
	    if (i > 0) {
		allViews += ','; 
		}
		allViews += JSON.stringify(viewHtml.views[viewHtml.viewNames[i]], null, 1);
	   }
	  allViews  += ']';
      $("#viewsOutput").text(allViews);

	  var allDataSets  = '[';
      for (var i=0; i < dataSetHtml.dataSets.length; i++) { 
	    if (i > 0) {
		allDataSets += ','; 
		}
		allDataSets += JSON.stringify(dataSetHtml.dataSets[dataSetHtml.dataSetNames[i]], null, 1);
	   }
	  allDataSets  += ']';
	  
      $("#dataSetsOutput").text(allDataSets);

	  var modelClasses ="";

	  for (var i=0; i < dataSetHtml.models.length; i++) { 
	    if (i > 0) {
		modelClasses += '\n\n'; 
		}
		modelClasses += dataSetHtml.models[dataSetHtml.dataSetNames[i]];
	  }
      $("#modelsOutput").text(modelClasses);
	  

    });
  });  

</script>
</body>

</html>

